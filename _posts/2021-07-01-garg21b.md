---
title: On Proximal Policy Optimization’s Heavy-tailed Gradients
abstract: Modern policy gradient algorithms such as Proximal Policy Optimization (PPO)
  rely on an arsenal of heuristics, including loss clipping and gradient clipping,
  to ensure successful learning. These heuristics are reminiscent of techniques from
  robust statistics, commonly used for estimation in outlier-rich ("heavy-tailed")
  regimes. In this paper, we present a detailed empirical study to characterize the
  heavy-tailed nature of the gradients of the PPO surrogate reward function. We demonstrate
  that the gradients, especially for the actor network, exhibit pronounced heavy-tailedness
  and that it increases as the agent’s policy diverges from the behavioral policy
  (i.e., as the agent goes further off policy). Further examination implicates the
  likelihood ratios and advantages in the surrogate reward as the main sources of
  the observed heavy-tailedness. We then highlight issues arising due to the heavy-tailed
  nature of the gradients. In this light, we study the effects of the standard PPO
  clipping heuristics, demonstrating that these tricks primarily serve to offset heavy-tailedness
  in gradients. Thus motivated, we propose incorporating GMOM, a high-dimensional
  robust estimator, into PPO as a substitute for three clipping tricks. Despite requiring
  less hyperparameter tuning, our method matches the performance of PPO (with all
  heuristics enabled) on a battery of MuJoCo continuous control tasks.
layout: inproceedings
series: Proceedings of Machine Learning Research
publisher: PMLR
issn: 2640-3498
id: garg21b
month: 0
tex_title: On Proximal Policy Optimization’s Heavy-tailed Gradients
firstpage: 3610
lastpage: 3619
page: 3610-3619
order: 3610
cycles: false
bibtex_author: Garg, Saurabh and Zhanson, Joshua and Parisotto, Emilio and Prasad,
  Adarsh and Kolter, Zico and Lipton, Zachary and Balakrishnan, Sivaraman and Salakhutdinov,
  Ruslan and Ravikumar, Pradeep
author:
- given: Saurabh
  family: Garg
- given: Joshua
  family: Zhanson
- given: Emilio
  family: Parisotto
- given: Adarsh
  family: Prasad
- given: Zico
  family: Kolter
- given: Zachary
  family: Lipton
- given: Sivaraman
  family: Balakrishnan
- given: Ruslan
  family: Salakhutdinov
- given: Pradeep
  family: Ravikumar
date: 2021-07-01
address:
container-title: Proceedings of the 38th International Conference on Machine Learning
volume: '139'
genre: inproceedings
issued:
  date-parts:
  - 2021
  - 7
  - 1
pdf: http://proceedings.mlr.press/v139/garg21b/garg21b.pdf
extras:
- label: Supplementary PDF
  link: http://proceedings.mlr.press/v139/garg21b/garg21b-supp.pdf
# Format based on citeproc: http://blog.martinfenner.org/2013/07/30/citeproc-yaml-for-bibliographies/
---
